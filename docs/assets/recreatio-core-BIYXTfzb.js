var V=Object.defineProperty;var X=(e,t,i)=>t in e?V(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var J=(e,t,i)=>X(e,typeof t!="symbol"?t+"":t,i);import{r as m,j as n}from"./vendor-CAC2WLor.js";import{r as L}from"./vendor-cogita-ui-DTaQ_FiW.js";const G="https://api.recreatio.pl";let D=null;function W(e){const t=document.cookie.match(new RegExp(`(?:^|; )${e}=([^;]*)`));return t?decodeURIComponent(t[1]):null}function M(){return W("XSRF-TOKEN")??D}class y extends Error{constructor(i,r){super(r);J(this,"status");this.status=i,this.name="ApiError"}}async function s(e,t){const i=M(),r=await fetch(`${G}${e}`,{...t,credentials:"include",headers:{"Content-Type":"application/json",...i?{"X-XSRF-TOKEN":i}:{},...t.headers??{}}});if(!r.ok){const a=await r.text();throw new y(r.status,a||r.statusText)}if(r.status===204)return;const c=await r.text();if(c)return JSON.parse(c)}function z(e){return s("/auth/register",{method:"POST",body:JSON.stringify({loginId:e.loginId,userSaltBase64:e.userSaltBase64,h3Base64:e.h3Base64,displayName:e.displayName??null})})}function q(){return s("/auth/csrf",{method:"GET"}).then(e=>(D=e.token,e))}function K(e){const t=new URLSearchParams({loginId:e});return s(`/auth/salt?${t.toString()}`,{method:"GET"})}function Z(e){const t=new URLSearchParams({loginId:e});return s(`/auth/availability?${t.toString()}`,{method:"GET"})}function Q(e){return s("/auth/login",{method:"POST",body:JSON.stringify({loginId:e.loginId,h3Base64:e.h3Base64,secureMode:e.secureMode,deviceInfo:e.deviceInfo??null})})}function B(){return s("/auth/me",{method:"GET"})}function Y(){return s("/auth/logout",{method:"POST",body:JSON.stringify({})})}function _(e){return s("/auth/session/mode",{method:"POST",body:JSON.stringify({secureMode:e})})}function ee(e){return s("/auth/password-change",{method:"POST",body:JSON.stringify(e)})}function ve(){return s("/account/profile",{method:"GET"})}function Ie(e){return s("/account/profile",{method:"POST",body:JSON.stringify(e)})}function $e(){return s("/account/roles",{method:"GET"})}function we(e){return s("/account/roles",{method:"POST",body:JSON.stringify(e)})}function Te(e,t){return s(`/account/roles/${e}/data`,{method:"POST",body:JSON.stringify(t)})}function xe(e,t){return s(`/account/data/${e}`,{method:"POST",body:JSON.stringify(t)})}function Ce(e){return s(`/account/data/${e}`,{method:"DELETE"})}function pe(e,t){return s(`/account/data/${e}/shares`,{method:"POST",body:JSON.stringify(t)})}function ke(){return s("/account/data/shares",{method:"GET"})}function Pe(e,t){return s(`/account/data/shares/${e}/accept`,{method:"POST",body:JSON.stringify(t)})}function Ee(e,t){return s(`/account/roles/${e}/shares`,{method:"POST",body:JSON.stringify(t)})}function Re(){return s("/account/shares",{method:"GET"})}function Ne(e,t){return s(`/account/shares/${e}/accept`,{method:"POST",body:JSON.stringify(t)})}function ye(e,t){return s(`/roles/${e}/edges`,{method:"POST",body:JSON.stringify(t)})}function je(){return s("/account/roles/graph",{method:"GET"})}function Oe(e){return s(`/account/roles/${e}/lookup`,{method:"GET"})}function Le(e){return s(`/account/roles/${e}/parents`,{method:"GET"})}function Ge(e,t){return s(`/account/roles/${e}/parents/${t}`,{method:"DELETE"})}function Me(e){return s(`/account/roles/${e}/verify`,{method:"GET"})}function Je(e,t){return s(`/account/roles/${e}/recovery/activate`,{method:"POST",body:JSON.stringify(t)})}function qe(){return s("/cogita/libraries",{method:"GET"})}function Be(e){return s("/cogita/libraries",{method:"POST",body:JSON.stringify({name:e.name,signatureBase64:e.signatureBase64??null})})}function Ue(e){return s(`/cogita/libraries/${e}/stats`,{method:"GET"})}function Ae(e){const t=new URLSearchParams;e.type&&t.set("type",e.type),e.query&&t.set("query",e.query),e.limit&&t.set("limit",String(e.limit));const i=t.toString();return s(`/cogita/libraries/${e.libraryId}/infos${i?`?${i}`:""}`,{method:"GET"})}function De(e){const t=new URLSearchParams;e.type&&t.set("type",e.type),e.query&&t.set("query",e.query),e.limit&&t.set("limit",String(e.limit)),e.filters&&Object.keys(e.filters).length>0&&t.set("filters",JSON.stringify(e.filters));const i=t.toString();return s(`/cogita/libraries/${e.libraryId}/entities/search${i?`?${i}`:""}`,{method:"GET"})}function Ke(e){const t=new URLSearchParams;e.type&&t.set("type",e.type),e.query&&t.set("query",e.query),e.limit&&t.set("limit",String(e.limit)),e.cursor&&t.set("cursor",e.cursor),e.languageAId&&t.set("languageAId",e.languageAId),e.languageBId&&t.set("languageBId",e.languageBId),e.topicId&&t.set("topicId",e.topicId),e.levelId&&t.set("levelId",e.levelId);const i=t.toString();return s(`/cogita/libraries/${e.libraryId}/cards${i?`?${i}`:""}`,{method:"GET"})}function Fe(e){const t=new URLSearchParams;e.query&&t.set("query",e.query),e.limit&&t.set("limit",String(e.limit)),e.cursor&&t.set("cursor",e.cursor);const i=t.toString();return s(`/cogita/libraries/${e.libraryId}/collections${i?`?${i}`:""}`,{method:"GET"})}function He(e,t){return s(`/cogita/libraries/${e}/collections/${t}`,{method:"GET"})}function Ve(e){return s(`/cogita/libraries/${e.libraryId}/infos/${e.infoId}/collections`,{method:"GET"})}function Xe(e){return e.collectionId?s(`/cogita/libraries/${e.libraryId}/collections/${e.collectionId}/revisions`,{method:"GET"}):s(`/cogita/libraries/${e.libraryId}/revisions`,{method:"GET"})}function We(e){return e.collectionId?s(`/cogita/libraries/${e.libraryId}/collections/${e.collectionId}/revisions/${e.revisionId}`,{method:"GET"}):s(`/cogita/libraries/${e.libraryId}/revisions/${e.revisionId}`,{method:"GET"})}function ze(e){return s(`/cogita/libraries/${e.libraryId}/revisions`,{method:"POST",body:JSON.stringify({collectionId:e.collectionId,name:e.name,revisionType:e.revisionType??null,revisionSettings:e.revisionSettings??null,mode:e.mode,check:e.check,limit:e.limit})})}function Ze(e){return s(`/cogita/libraries/${e.libraryId}/revisions/${e.revisionId}`,{method:"POST",body:JSON.stringify({collectionId:e.targetCollectionId??null,name:e.name,revisionType:e.revisionType??null,revisionSettings:e.revisionSettings??null,mode:e.mode,check:e.check,limit:e.limit})})}function Qe(e){const t=new URLSearchParams;e.limit&&t.set("limit",String(e.limit)),e.cursor&&t.set("cursor",e.cursor);const i=t.toString();return s(`/cogita/libraries/${e.libraryId}/collections/${e.collectionId}/cards${i?`?${i}`:""}`,{method:"GET"})}function Ye(e){return s(`/cogita/libraries/${e.libraryId}/review-outcomes`,{method:"POST",body:JSON.stringify(e.outcome)})}function _e(e){return s(`/cogita/libraries/${e.libraryId}/review-outcomes/bulk`,{method:"POST",body:JSON.stringify({outcomes:e.outcomes})})}function et(e){return s(`/cogita/libraries/${e.libraryId}/computed/${e.infoId}/sample`,{method:"GET"})}function tt(e){return s(`/cogita/libraries/${e.libraryId}/reviewers`,{method:"GET"})}function it(e){const t=new URLSearchParams;e.personRoleId&&t.set("personRoleId",e.personRoleId),e.checkType&&t.set("checkType",e.checkType),e.direction&&t.set("direction",e.direction);const i=t.toString();return s(`/cogita/libraries/${e.libraryId}/reviews/${e.itemType}/${e.itemId}/summary${i?`?${i}`:""}`,{method:"GET"})}function st(e){return s(`/cogita/libraries/${e.libraryId}/revision-shares`,{method:"POST",body:JSON.stringify({revisionId:e.revisionId,signatureBase64:e.signatureBase64??null})})}function nt(e){return s(`/cogita/libraries/${e.libraryId}/revision-shares`,{method:"GET"})}function rt(e){return s(`/cogita/libraries/${e.libraryId}/revision-shares/${e.shareId}/revoke`,{method:"POST",body:JSON.stringify({})})}function ot(e){return s(`/cogita/libraries/${e.libraryId}/revisions/${e.revisionId}/live-sessions`,{method:"POST",body:JSON.stringify({revisionId:e.revisionId,collectionId:e.collectionId??null,title:e.title??null,sessionMode:e.sessionMode??"simultaneous",hostViewMode:e.hostViewMode??"panel",participantViewMode:e.participantViewMode??"question",sessionSettings:e.sessionSettings??null})})}function at(e){return s(`/cogita/libraries/${e.libraryId}/revisions/${e.revisionId}/live-sessions/${e.sessionId}`,{method:"PUT",body:JSON.stringify({title:e.title??null,sessionMode:e.sessionMode??null,hostViewMode:e.hostViewMode??null,participantViewMode:e.participantViewMode??null,sessionSettings:e.sessionSettings??null})})}function ct(e){return s(`/cogita/libraries/${e.libraryId}/live-sessions`,{method:"GET"})}function ut(e){return s(`/cogita/libraries/${e.libraryId}/revisions/${e.revisionId}/live-sessions`,{method:"GET"})}function lt(e){return s(`/cogita/libraries/${e.libraryId}/live-sessions/participating`,{method:"GET"})}function dt(e){return s(`/cogita/libraries/${e.libraryId}/live-sessions/${e.sessionId}/host/attach`,{method:"POST",body:JSON.stringify({})})}function ht(e){const t=new URLSearchParams({hostSecret:e.hostSecret});return s(`/cogita/libraries/${e.libraryId}/live-sessions/${e.sessionId}?${t.toString()}`,{method:"GET"})}function ft(e){const t=new URLSearchParams({hostSecret:e.hostSecret});return s(`/cogita/libraries/${e.libraryId}/live-sessions/${e.sessionId}/host/state?${t.toString()}`,{method:"POST",body:JSON.stringify({status:e.status,currentRoundIndex:e.currentRoundIndex,revealVersion:e.revealVersion,currentPrompt:e.currentPrompt??null,currentReveal:e.currentReveal??null})})}function gt(e){const t=new URLSearchParams({hostSecret:e.hostSecret});return s(`/cogita/libraries/${e.libraryId}/live-sessions/${e.sessionId}/host/score?${t.toString()}`,{method:"POST",body:JSON.stringify({scores:e.scores})})}function mt(e){const t=new URLSearchParams({hostSecret:e.hostSecret});return s(`/cogita/libraries/${e.libraryId}/live-sessions/${e.sessionId}/host/relogin-requests/${e.requestId}/approve?${t.toString()}`,{method:"POST",body:JSON.stringify({})})}function bt(e){const t=new URLSearchParams({hostSecret:e.hostSecret});return s(`/cogita/libraries/${e.libraryId}/live-sessions/${e.sessionId}/host/close?${t.toString()}`,{method:"POST",body:JSON.stringify({})})}function St(e){return s(`/cogita/public/live-revision/${encodeURIComponent(e.code)}/join`,{method:"POST",body:JSON.stringify({name:e.name})})}function vt(e){return s(`/cogita/public/live-revision/${encodeURIComponent(e.code)}/relogin-request`,{method:"POST",body:JSON.stringify({name:e.name})})}function It(e){return s(`/cogita/public/live-revision/${encodeURIComponent(e.code)}/relogin-request/${encodeURIComponent(e.requestId)}`,{method:"GET"})}function $t(e){const t=new URLSearchParams;return e.participantToken&&t.set("participantToken",e.participantToken),s(`/cogita/public/live-revision/${encodeURIComponent(e.code)}/state${t.toString()?`?${t.toString()}`:""}`,{method:"GET"})}function wt(e){return s(`/cogita/public/live-revision/${encodeURIComponent(e.code)}/answer`,{method:"POST",body:JSON.stringify({participantToken:e.participantToken,roundIndex:e.roundIndex,cardKey:e.cardKey??null,answer:e.answer??null})})}function Tt(e){const t=new URLSearchParams;return e.key&&t.set("key",e.key),s(`/cogita/public/revision/${e.shareId}${t.toString()?`?${t.toString()}`:""}`,{method:"GET"})}function xt(e){const t=new URLSearchParams;return e.key&&t.set("key",e.key),e.type&&t.set("type",e.type),e.query&&t.set("query",e.query),s(`/cogita/public/revision/${e.shareId}/infos${t.toString()?`?${t.toString()}`:""}`,{method:"GET"})}function Ct(e){const t=new URLSearchParams;return e.key&&t.set("key",e.key),t.set("limit",String(e.limit)),e.cursor&&t.set("cursor",e.cursor),s(`/cogita/public/revision/${e.shareId}/cards${t.toString()?`?${t.toString()}`:""}`,{method:"GET"})}function pt(e){const t=new URLSearchParams;return e.key&&t.set("key",e.key),s(`/cogita/public/revision/${e.shareId}/computed/${e.infoId}/sample${t.toString()?`?${t.toString()}`:""}`,{method:"GET"})}function kt(e){return s(`/cogita/libraries/${e.libraryId}/dependency-graph`,{method:"GET"})}function Pt(e){return s(`/cogita/libraries/${e.libraryId}/dependency-graph`,{method:"PUT",body:JSON.stringify({nodes:e.nodes,edges:e.edges,dataKeyId:e.dataKeyId??null,signatureBase64:e.signatureBase64??null})})}function Et(e){return s(`/cogita/libraries/${e.libraryId}/dependency-graph/preview`,{method:"POST",body:JSON.stringify({})})}function Rt(e){return s(`/cogita/libraries/${e.libraryId}/dependencies/items`,{method:"GET"})}function Nt(e){const t=new URLSearchParams;e.key&&t.set("key",e.key);const i=t.toString();return s(`/cogita/public/revision/${e.shareId}/dependencies${i?`?${i}`:""}`,{method:"GET"})}function yt(e){return s(`/cogita/libraries/${e.libraryId}/collections/${e.collectionId}/graph`,{method:"GET"})}function jt(e){return s(`/cogita/libraries/${e.libraryId}/collections/${e.collectionId}/graph`,{method:"PUT",body:JSON.stringify({nodes:e.nodes,edges:e.edges,dataKeyId:e.dataKeyId??null,signatureBase64:e.signatureBase64??null})})}function Ot(e){return s(`/cogita/libraries/${e.libraryId}/infos`,{method:"POST",body:JSON.stringify({infoType:e.infoType,payload:e.payload,links:e.links??null,dataKeyId:e.dataKeyId??null,signatureBase64:e.signatureBase64??null})})}function Lt(e){return s(`/cogita/libraries/${e.libraryId}/infos/${e.infoId}`,{method:"GET"})}function Gt(e){return s(`/cogita/libraries/${e.libraryId}/approaches/specification`,{method:"GET"})}function Mt(e){return s(`/cogita/libraries/${e.libraryId}/infos/${e.infoId}/approaches/${encodeURIComponent(e.approachKey)}`,{method:"GET"})}function Jt(e){return s(`/cogita/libraries/${e.libraryId}/infos/${e.infoId}/checkcards`,{method:"GET"})}function qt(e){return s(`/cogita/libraries/${e.libraryId}/infos/${e.infoId}/checkcards/dependencies`,{method:"GET"})}function Bt(e){const t=new URLSearchParams;return e.key&&t.set("key",e.key),s(`/cogita/public/revision/${e.shareCode}/infos/${e.infoId}${t.toString()?`?${t.toString()}`:""}`,{method:"GET"})}function Ut(e){return s(`/cogita/libraries/${e.libraryId}/info-types/specification`,{method:"GET"})}function At(e){return s(`/cogita/libraries/${e.libraryId}/infos/${e.infoId}`,{method:"PUT",body:JSON.stringify({payload:e.payload,links:e.links??null,dataKeyId:e.dataKeyId??null,signatureBase64:e.signatureBase64??null})})}function Dt(e){return s(`/cogita/libraries/${e.libraryId}/collections`,{method:"POST",body:JSON.stringify({name:e.name,notes:e.notes??null,items:e.items,graph:e.graph?{nodes:e.graph.nodes,edges:e.graph.edges,dataKeyId:e.graph.dataKeyId??null,signatureBase64:e.graph.signatureBase64??null}:null,dataKeyId:e.dataKeyId??null,signatureBase64:e.signatureBase64??null})})}function Kt(e){return s(`/cogita/libraries/${e.libraryId}/collections/${e.collectionId}`,{method:"PUT",body:JSON.stringify({name:e.name,notes:e.notes??null})})}function N(e,t,i){if(!e)return;const r=i&&i>0?Math.round(t/i*100):null;e({loadedBytes:t,totalBytes:i??null,percent:r})}async function Ft(e,t){const i=M(),r=await fetch(`${G}/cogita/libraries/${e}/export`,{method:"GET",credentials:"include",headers:{...i?{"X-XSRF-TOKEN":i}:{}}});if(!r.ok){const b=await r.text();throw new y(r.status,b||r.statusText)}if(!r.body){const b=await r.blob();return N(t,b.size,b.size),b}const c=r.headers.get("Content-Length"),a=c?Number.parseInt(c,10):null,l=r.body.getReader(),o=[];let d=0;for(;;){const{value:b,done:f}=await l.read();if(f)break;b&&(o.push(b),d+=b.length,N(t,d,a))}return N(t,d,a??d),new Blob(o,{type:"application/json"})}function Ht(e,t,i,r){const c=M();return new Promise((a,l)=>{const o=new XMLHttpRequest;o.open("POST",`${G}/cogita/libraries/${e}/import/stream`),o.responseType="text",o.withCredentials=!0,o.setRequestHeader("Content-Type","application/json"),c&&o.setRequestHeader("X-XSRF-TOKEN",c),o.upload.onprogress=f=>{if(!f.lengthComputable){N(i,f.loaded,null);return}N(i,f.loaded,f.total)};let d=0;const b=f=>{const g=f.slice(d);d=f.length;const I=g.split(`
`);for(const S of I){const T=S.trim();if(T){if(T.startsWith("progress "))try{const w=JSON.parse(T.replace("progress ",""));r==null||r(w)}catch{}else if(T.startsWith("done "))try{const w=JSON.parse(T.replace("done ",""));a(w)}catch(w){l(w instanceof Error?w:new Error("Import parsing failed"))}}}};o.onprogress=()=>{typeof o.responseText=="string"&&b(o.responseText)},o.onload=()=>{if(typeof o.responseText=="string"&&b(o.responseText),o.status>=200&&o.status<300){if(typeof o.responseText=="string"&&o.responseText.includes("done "))return;try{const g=JSON.parse(o.responseText||"{}");a(g);return}catch{a({infosImported:0,connectionsImported:0,collectionsImported:0});return}}const f=typeof o.response=="string"?o.response:o.response?JSON.stringify(o.response):o.statusText;l(new y(o.status,f||"Import failed"))},o.onerror=()=>{l(new y(o.status||500,o.statusText||"Import failed"))},o.send(t)})}function Vt(){return s("/parish",{method:"GET"})}function Xt(e){return s(`/parish/${e}`,{method:"GET"})}function Wt(e){return s("/parish",{method:"POST",body:JSON.stringify(e)})}function zt(e,t){return s(`/parish/${e}/site`,{method:"PUT",body:JSON.stringify(t)})}function Zt(e,t){const i=new URLSearchParams,r=i.toString()?`?${i.toString()}`:"";return s(`/parish/${e}/public/intentions${r}`,{method:"GET"})}function Qt(e,t){const i=new URLSearchParams,r=i.toString()?`?${i.toString()}`:"";return s(`/parish/${e}/public/masses${r}`,{method:"GET"})}function Yt(e,t){return s(`/parish/${e}/masses`,{method:"POST",body:JSON.stringify({massDateTime:t.massDateTime,churchName:t.churchName,title:t.title,note:t.note??null,isCollective:t.isCollective??!1,durationMinutes:t.durationMinutes??null,kind:t.kind??null,beforeService:t.beforeService??null,afterService:t.afterService??null,intentions:t.intentions??[],donationSummary:t.donationSummary??null})})}function _t(e,t,i){return s(`/parish/${e}/masses/${t}`,{method:"PUT",body:JSON.stringify({massDateTime:i.massDateTime,churchName:i.churchName,title:i.title,note:i.note??null,isCollective:i.isCollective??!1,durationMinutes:i.durationMinutes??null,kind:i.kind??null,beforeService:i.beforeService??null,afterService:i.afterService??null,intentions:i.intentions??[],donationSummary:i.donationSummary??null})})}function ei(e){return s(`/parish/${e}/mass-rules`,{method:"GET"})}function ti(e,t){return s(`/parish/${e}/mass-rules`,{method:"POST",body:JSON.stringify(t)})}function ii(e,t,i){return s(`/parish/${e}/mass-rules/${t}`,{method:"PUT",body:JSON.stringify(i)})}function si(e,t,i){return s(`/parish/${e}/mass-rules/${t}/simulate`,{method:"POST",body:JSON.stringify({fromDate:i.fromDate,toDate:i.toDate,includeExisting:i.includeExisting??!1})})}function ni(e,t,i){return s(`/parish/${e}/mass-rules/${t}/apply`,{method:"POST",body:JSON.stringify({fromDate:i.fromDate,toDate:i.toDate,replaceExisting:i.replaceExisting??!1})})}const te=new TextEncoder;function F(e){const t=e instanceof Uint8Array?e:new Uint8Array(e),i=String.fromCharCode(...t);return btoa(i)}function ie(e){const t=atob(e),i=new Uint8Array(t.length);for(let r=0;r<t.length;r+=1)i[r]=t.charCodeAt(r);return i}function se(e=32){const t=crypto.getRandomValues(new Uint8Array(e));return F(t)}async function U(e){return crypto.subtle.digest("SHA-256",e)}async function ne(e,t,i,r){const c=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a=await crypto.subtle.importKey("raw",te.encode(e),{name:"PBKDF2"},!1,["deriveBits"]);return crypto.subtle.deriveBits({name:"PBKDF2",salt:c,iterations:i,hash:"SHA-256"},a,r*8)}async function j(e,t,i=15e4){const r=ie(t),c=await ne(e,r,i,32),a=await U(c),l=await U(a);return F(l)}const O=Number.parseInt("",10)||15e4,re="".split(",").map(e=>Number.parseInt(e.trim(),10)).filter(e=>Number.isFinite(e)&&e>0);async function oe(e){if(!(await Z(e.loginId)).isAvailable)throw new Error("Login ID is already in use.");const i=se(32),r=await j(e.password,i,O);return z({loginId:e.loginId,userSaltBase64:i,h3Base64:r,displayName:e.displayName??null})}async function ae(e){const t=[O,...re];for(let i=0;i<t.length;i+=1){const r=await K(e.loginId),c=await j(e.password,r.userSaltBase64,t[i]);try{return await Q({loginId:e.loginId,h3Base64:c,secureMode:e.secureMode,deviceInfo:e.deviceInfo??null})}catch(a){if(a instanceof y&&a.status===401&&i<t.length-1)continue;throw a}}throw new Error("Login failed.")}async function ri(e){const t=await K(e.loginId),i=await j(e.currentPassword,t.userSaltBase64,O),r=await j(e.newPassword,t.userSaltBase64,O);return ee({h3OldBase64:i,h3NewBase64:r})}const H=m.createContext(null);function oi({children:e}){const[t,i]=m.useState(null),[r,c]=m.useState({type:"idle"});m.useEffect(()=>{q().catch(()=>{})},[]),m.useEffect(()=>{let g=!0;return(async()=>{try{const S=await B();if(!g)return;i({userId:S.userId,sessionId:S.sessionId,secureMode:S.isSecureMode})}catch{if(!g)return}})(),()=>{g=!1}},[]);const a=m.useCallback(async g=>{await oe(g)},[]),l=m.useCallback(async g=>{const I=await ae(g);i({userId:I.userId,sessionId:I.sessionId,secureMode:I.secureMode})},[]),o=m.useCallback(async()=>{try{await q().catch(()=>{}),await Y()}catch{}finally{i(null)}},[]),d=m.useCallback(async()=>{const g=await B();i({userId:g.userId,sessionId:g.sessionId,secureMode:g.isSecureMode})},[]),b=m.useCallback(async g=>{const I=await _(g);i(S=>S&&{...S,sessionId:I.sessionId,secureMode:I.isSecureMode})},[]),f=m.useMemo(()=>({session:t,status:r,register:a,login:l,logout:o,refresh:d,setSecureMode:b,setStatus:c}),[t,r,a,l,o,d,b]);return n.jsx(H.Provider,{value:f,children:e})}function ai(){const e=m.useContext(H);if(!e)throw new Error("useAuth must be used within AuthProvider.");return e}const ce=new Set(["Aa123456","Pass@123","P@ssw0rd","Password1","Password123","Password","Passw0rd","N0=Acc3ss","Sojdlg123aljg","YAgjecc826","SZ9kQcCTwY","3rJs1la7qE","a838hfiD","iG4abOX4","W5tXn36alfW","N8ZGT5P0sHw=","Groupd2013","3Odi15ngxB","qti7Zxh18U","P@ssw0rd"]);function ci(e,t){if(e.length<8)return{ok:!1,message:t.tooShort};if(ce.has(e.toLowerCase()))return{ok:!1,message:t.common};const i=/[A-Z]/.test(e),r=/[a-z]/.test(e),c=/\\d/.test(e),a=/[^A-Za-z\\d]/.test(e);return[i,r,c,a].filter(Boolean).length<3?{ok:!1,message:t.weak}:{ok:!0,message:t.strong}}function ue({copy:e,mode:t,onModeChange:i,loginId:r,onLoginIdChange:c,displayName:a,onDisplayNameChange:l,password:o,onPasswordChange:d,passwordConfirm:b,onPasswordConfirmChange:f,secureMode:g,onSecureModeChange:I,availability:S,passwordHint:T,onSubmit:w,compact:k}){return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"tabs",children:[n.jsx("button",{type:"button",className:t==="login"?"active":"",onClick:()=>i("login"),children:e.access.login}),n.jsx("button",{type:"button",className:t==="register"?"active":"",onClick:()=>i("register"),children:e.access.register})]}),t==="register"?n.jsxs("form",{onSubmit:w,className:`auth-form ${k?"compact":""}`.trim(),children:[n.jsxs("label",{children:[e.access.loginId,n.jsx("input",{type:"text",value:r,onChange:v=>c(v.target.value)})]}),n.jsxs("label",{children:[e.access.displayName,n.jsx("input",{type:"text",value:a,onChange:v=>l(v.target.value)})]}),n.jsxs("label",{children:[e.access.password,n.jsx("input",{type:"password",value:o,onChange:v=>d(v.target.value)})]}),T&&n.jsx("span",{className:"hint",children:T}),n.jsxs("label",{children:[e.access.confirm,n.jsx("input",{type:"password",value:b,onChange:v=>f(v.target.value)})]}),S&&n.jsx("span",{className:"hint",children:S}),n.jsx("button",{type:"submit",className:"cta",children:e.access.create})]}):n.jsxs("form",{onSubmit:w,className:`auth-form ${k?"compact":""}`.trim(),children:[n.jsxs("label",{children:[e.access.loginId,n.jsx("input",{type:"text",value:r,onChange:v=>c(v.target.value)})]}),n.jsxs("label",{children:[e.access.password,n.jsx("input",{type:"password",value:o,onChange:v=>d(v.target.value)})]}),n.jsxs("label",{className:"toggle",children:[n.jsx("input",{type:"checkbox",checked:g,onChange:v=>I(v.target.checked)}),e.access.secureMode]}),n.jsx("button",{type:"submit",className:"cta",children:e.access.signIn})]})]})}function le({copy:e,mode:t,onModeChange:i,loginId:r,onLoginIdChange:c,displayName:a,onDisplayNameChange:l,password:o,onPasswordChange:d,passwordConfirm:b,onPasswordConfirmChange:f,secureMode:g,onSecureModeChange:I,availability:S,passwordHint:T,status:w,onSubmit:k,onCheckSession:v,onToggleMode:C,onLogout:R,sessionInfo:p,compact:P=!1,showSessionActions:h=!0}){return n.jsxs("div",{className:`auth-panel ${P?"auth-panel-compact":""}`.trim(),children:[n.jsx(ue,{copy:e,mode:t,onModeChange:i,loginId:r,onLoginIdChange:c,displayName:a,onDisplayNameChange:l,password:o,onPasswordChange:d,passwordConfirm:b,onPasswordConfirmChange:f,secureMode:g,onSecureModeChange:I,availability:S,passwordHint:T,onSubmit:k,compact:P}),w.type!=="idle"&&n.jsxs("div",{className:`status ${w.type}`,children:[n.jsx("strong",{children:e.access.statusTitle}),n.jsx("span",{children:w.message??e.access.statusReady})]}),h&&v&&C&&R&&n.jsxs("div",{className:"session-actions",children:[n.jsx("button",{type:"button",onClick:v,children:e.access.checkSession}),n.jsx("button",{type:"button",onClick:C,children:e.access.toggleMode}),n.jsx("button",{type:"button",onClick:R,children:e.access.logout})]}),p&&n.jsx("p",{className:"session-info",children:p})]})}function ui({copy:e,mode:t,onModeChange:i,loginId:r,onLoginIdChange:c,displayName:a,onDisplayNameChange:l,password:o,onPasswordChange:d,passwordConfirm:b,onPasswordConfirmChange:f,secureMode:g,onSecureModeChange:I,availability:S,passwordHint:T,onSubmit:w,status:k,open:v,onClose:C,context:R}){const[p,P]=m.useState(v),[h,u]=m.useState(!1);if(m.useEffect(()=>{if(v){P(!0),u(!1);const x=window.requestAnimationFrame(()=>u(!0));return()=>window.cancelAnimationFrame(x)}if(!v&&p){u(!1);const x=window.setTimeout(()=>P(!1),720);return()=>window.clearTimeout(x)}},[v,p]),!p)return null;const $=R==="parish"?e.parish.title:R==="cogita"?e.cogita.title:R==="account"?e.account.title:e.loginCard.contextDefault;return n.jsx("div",{className:`login-overlay ${h?"is-active":""}`,onClick:C,children:n.jsxs("div",{className:"login-card",onClick:x=>x.stopPropagation(),children:[n.jsxs("div",{className:"login-card-header",children:[n.jsx("img",{src:"/logo_new.png",alt:e.loginCard.title}),n.jsx("span",{children:e.loginCard.title})]}),n.jsx("p",{className:"login-card-note",children:$}),n.jsx(le,{copy:e,mode:t,onModeChange:i,loginId:r,onLoginIdChange:c,displayName:a,onDisplayNameChange:l,password:o,onPasswordChange:d,passwordConfirm:b,onPasswordConfirmChange:f,secureMode:g,onSecureModeChange:I,availability:S,passwordHint:T,onSubmit:w,status:k,compact:!0,showSessionActions:!1})]})})}function de({value:e,onChange:t}){const[i,r]=m.useState(!1),c=m.useRef(null);m.useEffect(()=>{const l=d=>{c.current&&(c.current.contains(d.target)||r(!1))},o=d=>{d.key==="Escape"&&r(!1)};return document.addEventListener("mousedown",l),document.addEventListener("keydown",o),()=>{document.removeEventListener("mousedown",l),document.removeEventListener("keydown",o)}},[]);const a=l=>{t(l),r(!1)};return n.jsxs("div",{className:`lang-select ${i?"open":""}`,ref:c,children:[n.jsx("button",{type:"button",className:"lang-button",onClick:()=>r(l=>!l),children:e.toUpperCase()}),n.jsxs("div",{className:`lang-menu ${i?"open":""}`,children:[n.jsx("button",{type:"button",onClick:()=>a("pl"),children:"PL"}),n.jsx("button",{type:"button",onClick:()=>a("en"),children:"EN"}),n.jsx("button",{type:"button",onClick:()=>a("de"),children:"DE"})]})]})}function he({copy:e,label:t,secureMode:i,onNavigateProfile:r,onToggleSecureMode:c,onLogout:a}){const[l,o]=m.useState(!1),d=m.useRef(null),b=m.useRef("unknown");return m.useEffect(()=>{const f=I=>{d.current&&(d.current.contains(I.target)||o(!1))},g=I=>{I.key==="Escape"&&o(!1)};return document.addEventListener("mousedown",f),document.addEventListener("keydown",g),()=>{document.removeEventListener("mousedown",f),document.removeEventListener("keydown",g)}},[]),n.jsxs("div",{className:`profile-menu ${l?"open":""}`,ref:d,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),onPointerDown:f=>{b.current=f.pointerType},children:[n.jsx("button",{type:"button",className:"profile-button",onClick:f=>{if(b.current==="touch"||b.current==="pen"){f.preventDefault(),o(g=>!g);return}r()},children:t}),n.jsxs("div",{className:`profile-dropdown ${l?"open":""}`,children:[n.jsx("button",{type:"button",onClick:()=>{r(),o(!1)},children:e.accountMenu.profile}),n.jsx("button",{type:"button",onClick:()=>{c(),o(!1)},children:i?e.accountMenu.secureModeOff:e.accountMenu.secureModeOn}),n.jsx("button",{type:"button",onClick:()=>{a(),o(!1)},children:e.accountMenu.logout})]})]})}function fe({copy:e,label:t,isAuthenticated:i,secureMode:r,onLogin:c,onProfileNavigate:a,onToggleSecureMode:l,onLogout:o,variant:d="cta"}){return i?n.jsx(he,{copy:e,label:t,secureMode:r,onNavigateProfile:a,onToggleSecureMode:l,onLogout:o}):n.jsx("button",{type:"button",className:d,onClick:c,children:t})}function li({copy:e,language:t,onLanguageChange:i,onNavigate:r,onOpenPanel:c,onAuthAction:a,authLabel:l,authCtaLabel:o,showProfileMenu:d,onProfileNavigate:b,onToggleSecureMode:f,onLogout:g,secureMode:I,panelOpen:S,activeSectionId:T,onSectionChange:w}){const k=m.useRef(null),v=()=>{const h=k.current,u=(h==null?void 0:h.clientHeight)??0;return Number.isFinite(u)&&u>1?u:window.innerHeight||1},C=m.useMemo(()=>{var $,x;const h=(($=e.faq.items[0])==null?void 0:$.a)??e.hero.subtitle,u=((x=e.legal.items[0])==null?void 0:x.desc)??e.hero.subtitle;return[{id:"section-1",title:e.hero.headline,text:e.hero.subtitle,ctaLabel:o,ctaAction:a},{id:"section-2",title:e.parish.title,text:e.parish.subtitle,ctaLabel:e.nav.parish,ctaAction:()=>r("parish")},{id:"section-3",title:e.cogita.title,text:e.cogita.subtitle,ctaLabel:e.nav.cogita,ctaAction:()=>r("cogita")},{id:"section-4",title:e.faq.title,text:h,ctaLabel:e.nav.faq,ctaAction:()=>c("faq"),variant:"secondary"},{id:"section-5",title:e.legal.title,text:u,ctaLabel:e.nav.legal,ctaAction:()=>c("legal"),variant:"secondary"}]},[o,e,a,r,c]),R=m.useMemo(()=>{const h=T??"section-1",u=C.findIndex($=>$.id===h);return u>=0?u:0},[T,C]),[p,P]=m.useState(R);return m.useEffect(()=>(document.body.style.overflow=S?"hidden":"",()=>{document.body.style.overflow=""}),[S]),m.useEffect(()=>{const h=k.current;if(!h)return;let u;const $=()=>{u&&window.clearTimeout(u),u=window.setTimeout(()=>{const x=v();if(!Number.isFinite(x)||x<=1)return;const E=Math.round(h.scrollTop/x);P(Math.max(0,Math.min(E,C.length-1)))},40)};return h.addEventListener("scroll",$,{passive:!0}),()=>{h.removeEventListener("scroll",$),u&&window.clearTimeout(u)}},[C.length]),m.useEffect(()=>{var u;if(S)return;const h=((u=C[p])==null?void 0:u.id)??"section-1";T!==h&&(w==null||w(h))},[p,T,w,S,C]),m.useEffect(()=>{if(S)return;const h=k.current;if(!h)return;const u=C.findIndex($=>$.id===(T??"section-1"));if(u>=0){const $=v();if(Number.isFinite($)&&$>1)h.scrollTo({top:u*$,behavior:"smooth"}),P(u);else{const x=window.requestAnimationFrame(()=>{const E=v();Number.isFinite(E)&&E>1&&(h.scrollTo({top:u*E,behavior:"smooth"}),P(u))});return()=>window.cancelAnimationFrame(x)}}},[T,S,C]),m.useEffect(()=>{const h=u=>{if(S)return;const $=k.current,x=v();if(!(!$||!Number.isFinite(x)||x<=1)){if(["ArrowDown","PageDown"].includes(u.key)){u.preventDefault();const E=Math.min(p+1,C.length-1);$.scrollTo({top:E*x,behavior:"auto"})}if(["ArrowUp","PageUp"].includes(u.key)){u.preventDefault();const E=Math.max(p-1,0);$.scrollTo({top:E*x,behavior:"auto"})}}};return window.addEventListener("keydown",h),()=>window.removeEventListener("keydown",h)},[p,S,C.length]),n.jsxs("div",{className:`home ${S?"home-panel-open":""}`,children:[n.jsxs("header",{className:"home-header",children:[n.jsx("button",{type:"button",className:"brand",onClick:()=>r("home"),children:n.jsx("img",{src:"/logo_new.svg",alt:e.loginCard.title})}),n.jsxs("nav",{className:"home-nav",children:[n.jsx("button",{type:"button",onClick:()=>r("parish"),children:e.nav.parish}),n.jsx("button",{type:"button",onClick:()=>r("cogita"),children:e.nav.cogita}),n.jsx("button",{type:"button",onClick:()=>c("faq"),children:e.nav.faq}),n.jsx("button",{type:"button",onClick:()=>c("legal"),children:e.nav.legal})]}),n.jsxs("div",{className:"home-actions",children:[n.jsx(de,{value:t,onChange:i}),n.jsx(fe,{copy:e,label:l,isAuthenticated:d,secureMode:I,onLogin:a,onProfileNavigate:b,onToggleSecureMode:f,onLogout:g,variant:"cta"})]})]}),n.jsx("main",{ref:k,className:"home-viewport","aria-hidden":S?"true":"false",children:C.map((h,u)=>n.jsx("section",{id:h.id,className:`home-section section-${u+1} ${p===u?"is-active":""}`,children:n.jsxs("div",{className:"home-content",children:[n.jsx("h1",{children:h.title}),n.jsx("p",{children:h.text}),n.jsx("button",{type:"button",className:`cta ${h.variant==="secondary"?"ghost":""}`,onClick:h.ctaAction,children:h.ctaLabel})]})},h.id))}),n.jsx("div",{className:"home-dots",children:C.map((h,u)=>n.jsx("button",{className:`dot ${p===u?"active":""}`,"aria-label":h.title,type:"button",onClick:()=>{const $=k.current;$&&($.scrollTo({top:u*$.clientHeight,behavior:"smooth"}),P(u))}},h.id))}),n.jsxs("footer",{className:"home-footer",children:[n.jsx("span",{children:e.footer.headline}),n.jsxs("div",{className:"footer-links",children:[n.jsx("button",{type:"button",onClick:()=>c("legal"),children:e.footer.imprint}),n.jsx("button",{type:"button",onClick:()=>c("faq"),children:e.footer.security})]})]})]})}const ge=e=>{const t=[];let i="",r=0;const c=l=>{let o=0;for(let d=l-1;d>=0&&e[d]==="\\";d-=1)o+=1;return o%2===1},a=()=>{i&&(t.push({type:"text",value:i.replace(/\\\$/g,"$")}),i="")};for(;r<e.length;){const l=e[r];if(l==="$"&&!c(r)){const o=e[r+1]==="$"&&!c(r+1),d=o?"$$":"$",b=r+d.length;let f=b,g=!1;for(;f<e.length;){if(e.startsWith(d,f)&&!c(f)){g=!0;break}f+=1}if(g){a();const I=e.slice(b,f);t.push({type:o?"block":"inline",value:I}),r=f+d.length;continue}}i+=l,r+=1}return a(),t},A=(e,t)=>{if(!e)return null;const i=e.split(/\r?\n/);return i.length===1?n.jsx("span",{children:e},t):n.jsx("span",{children:i.map((r,c)=>n.jsxs("span",{children:[r,c<i.length-1?n.jsx("br",{}):null]},`${t}-${c}`))},t)};function di({value:e,className:t,mode:i="math"}){if(!e)return null;if(i==="math")return n.jsx("div",{className:t,children:n.jsx(L.BlockMath,{math:e,renderError:()=>n.jsx("span",{children:e}),strict:"ignore"})});const r=ge(e);return r.some(a=>a.type!=="text")?n.jsx("div",{className:t,children:r.map((a,l)=>{const o=`latex-${l}`;return a.type==="text"?A(a.value,o):a.type==="block"?n.jsx(L.BlockMath,{math:a.value,strict:"ignore",renderError:()=>n.jsx("span",{children:a.value})},o):n.jsx(L.InlineMath,{math:a.value,strict:"ignore",renderError:()=>n.jsx("span",{children:a.value})},o)})}):n.jsx("div",{className:t,children:A(e,"latex-text")})}export{je as $,fe as A,Ft as B,Ht as C,He as D,Qe as E,yt as F,Dt as G,Kt as H,jt as I,ie as J,tt as K,de as L,We as M,nt as N,Ze as O,ze as P,st as Q,rt as R,_e as S,et as T,F as U,dt as V,ut as W,ot as X,at as Y,lt as Z,q as _,Ue as a,xe as a0,Te as a1,Be as a2,Tt as a3,xt as a4,Nt as a5,Bt as a6,Ct as a7,pt as a8,ht as a9,li as aA,le as aB,ui as aC,oi as aD,Ce as aE,Me as aF,Ge as aG,Le as aH,Pe as aI,ke as aJ,Ne as aK,Re as aL,Je as aM,pe as aN,Ee as aO,ye as aP,Oe as aQ,ve as aR,Ie as aS,ri as aT,gt as aa,ft as ab,bt as ac,mt as ad,It as ae,$t as af,St as ag,vt as ah,wt as ai,ct as aj,Vt as ak,Xt as al,Zt as am,Qt as an,ei as ao,Wt as ap,zt as aq,_t as ar,Yt as as,ii as at,ti as au,si as av,ni as aw,ai as ax,ci as ay,Z as az,qe as b,Xe as c,Rt as d,Gt as e,De as f,Fe as g,Lt as h,it as i,Ve as j,Jt as k,qt as l,Mt as m,Ae as n,Ot as o,Ut as p,y as q,kt as r,Ke as s,Et as t,At as u,Pt as v,di as w,Ye as x,$e as y,we as z};
