var W=Object.defineProperty;var Z=(e,t,n)=>t in e?W(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var D=(e,t,n)=>Z(e,typeof t!="symbol"?t+"":t,n);import{r as m,j as s}from"./vendor-DrCXrCXJ.js";import{r as N}from"./vendor-cogita-ui-DLgJCpO3.js";const G="https://api.recreatio.pl";let U=null;function z(e){const t=document.cookie.match(new RegExp(`(?:^|; )${e}=([^;]*)`));return t?decodeURIComponent(t[1]):null}function B(){return z("XSRF-TOKEN")??U}class O extends Error{constructor(n,r){super(r);D(this,"status");this.status=n,this.name="ApiError"}}async function i(e,t){const n=B(),r=await fetch(`${G}${e}`,{...t,credentials:"include",headers:{"Content-Type":"application/json",...n?{"X-XSRF-TOKEN":n}:{},...t.headers??{}}});if(!r.ok){const a=await r.text();throw new O(r.status,a||r.statusText)}if(r.status===204)return;const c=await r.text();if(c)return JSON.parse(c)}function V(e){return i("/auth/register",{method:"POST",body:JSON.stringify({loginId:e.loginId,userSaltBase64:e.userSaltBase64,h3Base64:e.h3Base64,displayName:e.displayName??null})})}function J(){return i("/auth/csrf",{method:"GET"}).then(e=>(U=e.token,e))}function K(e){const t=new URLSearchParams({loginId:e});return i(`/auth/salt?${t.toString()}`,{method:"GET"})}function Y(e){const t=new URLSearchParams({loginId:e});return i(`/auth/availability?${t.toString()}`,{method:"GET"})}function _(e){return i("/auth/login",{method:"POST",body:JSON.stringify({loginId:e.loginId,h3Base64:e.h3Base64,secureMode:e.secureMode,deviceInfo:e.deviceInfo??null})})}function A(){return i("/auth/me",{method:"GET"})}function Q(){return i("/auth/logout",{method:"POST",body:JSON.stringify({})})}function ee(e){return i("/auth/session/mode",{method:"POST",body:JSON.stringify({secureMode:e})})}function te(e){return i("/auth/password-change",{method:"POST",body:JSON.stringify(e)})}function Se(){return i("/account/profile",{method:"GET"})}function we(e){return i("/account/profile",{method:"POST",body:JSON.stringify(e)})}function ve(){return i("/account/roles",{method:"GET"})}function Ie(e){return i("/account/roles",{method:"POST",body:JSON.stringify(e)})}function Te(e,t){return i(`/account/roles/${e}/data`,{method:"POST",body:JSON.stringify(t)})}function $e(e,t){return i(`/account/data/${e}`,{method:"POST",body:JSON.stringify(t)})}function pe(e){return i(`/account/data/${e}`,{method:"DELETE"})}function ye(e,t){return i(`/account/data/${e}/shares`,{method:"POST",body:JSON.stringify(t)})}function ke(){return i("/account/data/shares",{method:"GET"})}function Ce(e,t){return i(`/account/data/shares/${e}/accept`,{method:"POST",body:JSON.stringify(t)})}function je(e,t){return i(`/account/roles/${e}/shares`,{method:"POST",body:JSON.stringify(t)})}function Ee(){return i("/account/shares",{method:"GET"})}function Ne(e,t){return i(`/account/shares/${e}/accept`,{method:"POST",body:JSON.stringify(t)})}function Pe(e,t){return i(`/roles/${e}/edges`,{method:"POST",body:JSON.stringify(t)})}function Oe(){return i("/account/roles/graph",{method:"GET"})}function Re(e){return i(`/account/roles/${e}/lookup`,{method:"GET"})}function Me(e){return i(`/account/roles/${e}/parents`,{method:"GET"})}function Le(e,t){return i(`/account/roles/${e}/parents/${t}`,{method:"DELETE"})}function Ge(e){return i(`/account/roles/${e}/verify`,{method:"GET"})}function Be(e,t){return i(`/account/roles/${e}/recovery/activate`,{method:"POST",body:JSON.stringify(t)})}function De(){return i("/cogita/libraries",{method:"GET"})}function Je(e){return i("/cogita/libraries",{method:"POST",body:JSON.stringify({name:e.name,signatureBase64:e.signatureBase64??null})})}function Ae(e){return i(`/cogita/libraries/${e}/stats`,{method:"GET"})}function qe(e){const t=new URLSearchParams;e.type&&t.set("type",e.type),e.query&&t.set("query",e.query),e.limit&&t.set("limit",String(e.limit));const n=t.toString();return i(`/cogita/libraries/${e.libraryId}/infos${n?`?${n}`:""}`,{method:"GET"})}function Ue(e){const t=new URLSearchParams;e.type&&t.set("type",e.type),e.query&&t.set("query",e.query),e.limit&&t.set("limit",String(e.limit)),e.cursor&&t.set("cursor",e.cursor),e.languageAId&&t.set("languageAId",e.languageAId),e.languageBId&&t.set("languageBId",e.languageBId),e.topicId&&t.set("topicId",e.topicId),e.levelId&&t.set("levelId",e.levelId);const n=t.toString();return i(`/cogita/libraries/${e.libraryId}/cards${n?`?${n}`:""}`,{method:"GET"})}function Ke(e){const t=new URLSearchParams;e.query&&t.set("query",e.query),e.limit&&t.set("limit",String(e.limit)),e.cursor&&t.set("cursor",e.cursor);const n=t.toString();return i(`/cogita/libraries/${e.libraryId}/collections${n?`?${n}`:""}`,{method:"GET"})}function Fe(e,t){return i(`/cogita/libraries/${e}/collections/${t}`,{method:"GET"})}function He(e){return i(`/cogita/libraries/${e.libraryId}/collections/${e.collectionId}/revisions`,{method:"GET"})}function Xe(e){return i(`/cogita/libraries/${e.libraryId}/collections/${e.collectionId}/revisions/${e.revisionId}`,{method:"GET"})}function We(e){return i(`/cogita/libraries/${e.libraryId}/collections/${e.collectionId}/revisions`,{method:"POST",body:JSON.stringify({name:e.name,revisionType:e.revisionType??null,revisionSettings:null,mode:e.mode,check:e.check,limit:e.limit})})}function Ze(e){return i(`/cogita/libraries/${e.libraryId}/collections/${e.collectionId}/revisions/${e.revisionId}`,{method:"POST",body:JSON.stringify({name:e.name,revisionType:e.revisionType??null,revisionSettings:e.revisionSettings??null,mode:e.mode,check:e.check,limit:e.limit})})}function ze(e){const t=new URLSearchParams;e.limit&&t.set("limit",String(e.limit)),e.cursor&&t.set("cursor",e.cursor);const n=t.toString();return i(`/cogita/libraries/${e.libraryId}/collections/${e.collectionId}/cards${n?`?${n}`:""}`,{method:"GET"})}function Ve(e){return i(`/cogita/libraries/${e.libraryId}/review-outcomes/bulk`,{method:"POST",body:JSON.stringify({outcomes:e.outcomes})})}function Ye(e){return i(`/cogita/libraries/${e.libraryId}/computed/${e.infoId}/sample`,{method:"GET"})}function _e(e){return i(`/cogita/libraries/${e.libraryId}/reviewers`,{method:"GET"})}function Qe(e){return i(`/cogita/libraries/${e.libraryId}/revision-shares`,{method:"POST",body:JSON.stringify({collectionId:e.collectionId,revisionType:e.revisionType??null,revisionSettings:e.revisionSettings??null,mode:e.mode,check:e.check,limit:e.limit,signatureBase64:e.signatureBase64??null})})}function et(e){return i(`/cogita/libraries/${e.libraryId}/revision-shares`,{method:"GET"})}function tt(e){return i(`/cogita/libraries/${e.libraryId}/revision-shares/${e.shareId}/revoke`,{method:"POST",body:JSON.stringify({})})}function nt(e){const t=new URLSearchParams;return e.key&&t.set("key",e.key),i(`/cogita/public/revision/${e.shareId}${t.toString()?`?${t.toString()}`:""}`,{method:"GET"})}function st(e){const t=new URLSearchParams;return e.key&&t.set("key",e.key),e.type&&t.set("type",e.type),e.query&&t.set("query",e.query),i(`/cogita/public/revision/${e.shareId}/infos${t.toString()?`?${t.toString()}`:""}`,{method:"GET"})}function rt(e){const t=new URLSearchParams;return e.key&&t.set("key",e.key),t.set("limit",String(e.limit)),e.cursor&&t.set("cursor",e.cursor),i(`/cogita/public/revision/${e.shareId}/cards${t.toString()?`?${t.toString()}`:""}`,{method:"GET"})}function it(e){const t=new URLSearchParams;return e.key&&t.set("key",e.key),i(`/cogita/public/revision/${e.shareId}/computed/${e.infoId}/sample${t.toString()?`?${t.toString()}`:""}`,{method:"GET"})}function ot(e){return i(`/cogita/libraries/${e.libraryId}/dependency-graph`,{method:"GET"})}function at(e){return i(`/cogita/libraries/${e.libraryId}/dependency-graph`,{method:"PUT",body:JSON.stringify({nodes:e.nodes,edges:e.edges,dataKeyId:e.dataKeyId??null,signatureBase64:e.signatureBase64??null})})}function ct(e){return i(`/cogita/libraries/${e.libraryId}/dependency-graph/preview`,{method:"POST",body:JSON.stringify({})})}function ut(e){return i(`/cogita/libraries/${e.libraryId}/dependencies/items`,{method:"GET"})}function lt(e){const t=new URLSearchParams;e.key&&t.set("key",e.key);const n=t.toString();return i(`/cogita/public/revision/${e.shareId}/dependencies${n?`?${n}`:""}`,{method:"GET"})}function dt(e){return i(`/cogita/libraries/${e.libraryId}/collections/${e.collectionId}/graph`,{method:"GET"})}function ht(e){return i(`/cogita/libraries/${e.libraryId}/collections/${e.collectionId}/graph`,{method:"PUT",body:JSON.stringify({nodes:e.nodes,edges:e.edges,dataKeyId:e.dataKeyId??null,signatureBase64:e.signatureBase64??null})})}function ft(e){return i(`/cogita/libraries/${e.libraryId}/collections/${e.collectionId}/graph/preview`,{method:"POST",body:JSON.stringify({})})}function gt(e){return i(`/cogita/libraries/${e.libraryId}/infos`,{method:"POST",body:JSON.stringify({infoType:e.infoType,payload:e.payload,dataKeyId:e.dataKeyId??null,signatureBase64:e.signatureBase64??null})})}function mt(e){return i(`/cogita/libraries/${e.libraryId}/infos/${e.infoId}`,{method:"GET"})}function bt(e){const t=new URLSearchParams;return e.key&&t.set("key",e.key),i(`/cogita/public/revision/${e.shareCode}/infos/${e.infoId}${t.toString()?`?${t.toString()}`:""}`,{method:"GET"})}function xt(e){return i(`/cogita/libraries/${e.libraryId}/infos/${e.infoId}`,{method:"PUT",body:JSON.stringify({payload:e.payload,dataKeyId:e.dataKeyId??null,signatureBase64:e.signatureBase64??null})})}function St(e){return i(`/cogita/libraries/${e.libraryId}/connections`,{method:"POST",body:JSON.stringify({connectionType:e.connectionType,infoIds:e.infoIds,payload:e.payload??null,dataKeyId:e.dataKeyId??null,signatureBase64:e.signatureBase64??null})})}function wt(e){return i(`/cogita/libraries/${e.libraryId}/connections/${e.connectionId}`,{method:"DELETE"})}function vt(e){return i(`/cogita/libraries/${e.libraryId}/collections`,{method:"POST",body:JSON.stringify({name:e.name,notes:e.notes??null,items:e.items,graph:e.graph?{nodes:e.graph.nodes,edges:e.graph.edges,dataKeyId:e.graph.dataKeyId??null,signatureBase64:e.graph.signatureBase64??null}:null,dataKeyId:e.dataKeyId??null,signatureBase64:e.signatureBase64??null})})}function P(e,t,n){if(!e)return;const r=n&&n>0?Math.round(t/n*100):null;e({loadedBytes:t,totalBytes:n??null,percent:r})}async function It(e,t){const n=B(),r=await fetch(`${G}/cogita/libraries/${e}/export`,{method:"GET",credentials:"include",headers:{...n?{"X-XSRF-TOKEN":n}:{}}});if(!r.ok){const b=await r.text();throw new O(r.status,b||r.statusText)}if(!r.body){const b=await r.blob();return P(t,b.size,b.size),b}const c=r.headers.get("Content-Length"),a=c?Number.parseInt(c,10):null,u=r.body.getReader(),o=[];let d=0;for(;;){const{value:b,done:f}=await u.read();if(f)break;b&&(o.push(b),d+=b.length,P(t,d,a))}return P(t,d,a??d),new Blob(o,{type:"application/json"})}function Tt(e,t,n,r){const c=B();return new Promise((a,u)=>{const o=new XMLHttpRequest;o.open("POST",`${G}/cogita/libraries/${e}/import/stream`),o.responseType="text",o.withCredentials=!0,o.setRequestHeader("Content-Type","application/json"),c&&o.setRequestHeader("X-XSRF-TOKEN",c),o.upload.onprogress=f=>{if(!f.lengthComputable){P(n,f.loaded,null);return}P(n,f.loaded,f.total)};let d=0;const b=f=>{const g=f.slice(d);d=f.length;const w=g.split(`
`);for(const x of w){const T=x.trim();if(T){if(T.startsWith("progress "))try{const I=JSON.parse(T.replace("progress ",""));r==null||r(I)}catch{}else if(T.startsWith("done "))try{const I=JSON.parse(T.replace("done ",""));a(I)}catch(I){u(I instanceof Error?I:new Error("Import parsing failed"))}}}};o.onprogress=()=>{typeof o.responseText=="string"&&b(o.responseText)},o.onload=()=>{if(typeof o.responseText=="string"&&b(o.responseText),o.status>=200&&o.status<300){if(typeof o.responseText=="string"&&o.responseText.includes("done "))return;try{const g=JSON.parse(o.responseText||"{}");a(g);return}catch{a({infosImported:0,connectionsImported:0,collectionsImported:0});return}}const f=typeof o.response=="string"?o.response:o.response?JSON.stringify(o.response):o.statusText;u(new O(o.status,f||"Import failed"))},o.onerror=()=>{u(new O(o.status||500,o.statusText||"Import failed"))},o.send(t)})}function $t(e){const t=new URLSearchParams({languageId:e.languageId,wordId:e.wordId});return i(`/cogita/libraries/${e.libraryId}/word-languages?${t.toString()}`,{method:"GET"})}function pt(){return i("/parish",{method:"GET"})}function yt(e){return i(`/parish/${e}`,{method:"GET"})}function kt(e){return i("/parish",{method:"POST",body:JSON.stringify(e)})}function Ct(e,t){return i(`/parish/${e}/site`,{method:"PUT",body:JSON.stringify(t)})}function jt(e,t){const n=new URLSearchParams,r=n.toString()?`?${n.toString()}`:"";return i(`/parish/${e}/public/intentions${r}`,{method:"GET"})}function Et(e,t){const n=new URLSearchParams,r=n.toString()?`?${n.toString()}`:"";return i(`/parish/${e}/public/masses${r}`,{method:"GET"})}function Nt(e,t){return i(`/parish/${e}/masses`,{method:"POST",body:JSON.stringify({massDateTime:t.massDateTime,churchName:t.churchName,title:t.title,note:t.note??null,isCollective:t.isCollective??!1,durationMinutes:t.durationMinutes??null,kind:t.kind??null,beforeService:t.beforeService??null,afterService:t.afterService??null,intentions:t.intentions??[],donationSummary:t.donationSummary??null})})}function Pt(e,t,n){return i(`/parish/${e}/masses/${t}`,{method:"PUT",body:JSON.stringify({massDateTime:n.massDateTime,churchName:n.churchName,title:n.title,note:n.note??null,isCollective:n.isCollective??!1,durationMinutes:n.durationMinutes??null,kind:n.kind??null,beforeService:n.beforeService??null,afterService:n.afterService??null,intentions:n.intentions??[],donationSummary:n.donationSummary??null})})}function Ot(e){return i(`/parish/${e}/mass-rules`,{method:"GET"})}function Rt(e,t){return i(`/parish/${e}/mass-rules`,{method:"POST",body:JSON.stringify(t)})}function Mt(e,t,n){return i(`/parish/${e}/mass-rules/${t}`,{method:"PUT",body:JSON.stringify(n)})}function Lt(e,t,n){return i(`/parish/${e}/mass-rules/${t}/simulate`,{method:"POST",body:JSON.stringify({fromDate:n.fromDate,toDate:n.toDate,includeExisting:n.includeExisting??!1})})}function Gt(e,t,n){return i(`/parish/${e}/mass-rules/${t}/apply`,{method:"POST",body:JSON.stringify({fromDate:n.fromDate,toDate:n.toDate,replaceExisting:n.replaceExisting??!1})})}const ne=new TextEncoder;function F(e){const t=e instanceof Uint8Array?e:new Uint8Array(e),n=String.fromCharCode(...t);return btoa(n)}function se(e){const t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;r+=1)n[r]=t.charCodeAt(r);return n}function re(e=32){const t=crypto.getRandomValues(new Uint8Array(e));return F(t)}async function q(e){return crypto.subtle.digest("SHA-256",e)}async function ie(e,t,n,r){const c=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a=await crypto.subtle.importKey("raw",ne.encode(e),{name:"PBKDF2"},!1,["deriveBits"]);return crypto.subtle.deriveBits({name:"PBKDF2",salt:c,iterations:n,hash:"SHA-256"},a,r*8)}async function R(e,t,n=15e4){const r=se(t),c=await ie(e,r,n,32),a=await q(c),u=await q(a);return F(u)}const M=Number.parseInt("",10)||15e4,oe="".split(",").map(e=>Number.parseInt(e.trim(),10)).filter(e=>Number.isFinite(e)&&e>0);async function ae(e){if(!(await Y(e.loginId)).isAvailable)throw new Error("Login ID is already in use.");const n=re(32),r=await R(e.password,n,M);return V({loginId:e.loginId,userSaltBase64:n,h3Base64:r,displayName:e.displayName??null})}async function ce(e){const t=[M,...oe];for(let n=0;n<t.length;n+=1){const r=await K(e.loginId),c=await R(e.password,r.userSaltBase64,t[n]);try{return await _({loginId:e.loginId,h3Base64:c,secureMode:e.secureMode,deviceInfo:e.deviceInfo??null})}catch(a){if(a instanceof O&&a.status===401&&n<t.length-1)continue;throw a}}throw new Error("Login failed.")}async function Bt(e){const t=await K(e.loginId),n=await R(e.currentPassword,t.userSaltBase64,M),r=await R(e.newPassword,t.userSaltBase64,M);return te({h3OldBase64:n,h3NewBase64:r})}const H=m.createContext(null);function Dt({children:e}){const[t,n]=m.useState(null),[r,c]=m.useState({type:"idle"});m.useEffect(()=>{J().catch(()=>{})},[]),m.useEffect(()=>{let g=!0;return(async()=>{try{const x=await A();if(!g)return;n({userId:x.userId,sessionId:x.sessionId,secureMode:x.isSecureMode})}catch{if(!g)return}})(),()=>{g=!1}},[]);const a=m.useCallback(async g=>{await ae(g)},[]),u=m.useCallback(async g=>{const w=await ce(g);n({userId:w.userId,sessionId:w.sessionId,secureMode:w.secureMode})},[]),o=m.useCallback(async()=>{try{await J().catch(()=>{}),await Q()}catch{}finally{n(null)}},[]),d=m.useCallback(async()=>{const g=await A();n({userId:g.userId,sessionId:g.sessionId,secureMode:g.isSecureMode})},[]),b=m.useCallback(async g=>{const w=await ee(g);n(x=>x&&{...x,sessionId:w.sessionId,secureMode:w.isSecureMode})},[]),f=m.useMemo(()=>({session:t,status:r,register:a,login:u,logout:o,refresh:d,setSecureMode:b,setStatus:c}),[t,r,a,u,o,d,b]);return s.jsx(H.Provider,{value:f,children:e})}function Jt(){const e=m.useContext(H);if(!e)throw new Error("useAuth must be used within AuthProvider.");return e}const ue=new Set(["Aa123456","Pass@123","P@ssw0rd","Password1","Password123","Password","Passw0rd","N0=Acc3ss","Sojdlg123aljg","YAgjecc826","SZ9kQcCTwY","3rJs1la7qE","a838hfiD","iG4abOX4","W5tXn36alfW","N8ZGT5P0sHw=","Groupd2013","3Odi15ngxB","qti7Zxh18U","P@ssw0rd"]);function At(e,t){if(e.length<8)return{ok:!1,message:t.tooShort};if(ue.has(e.toLowerCase()))return{ok:!1,message:t.common};const n=/[A-Z]/.test(e),r=/[a-z]/.test(e),c=/\\d/.test(e),a=/[^A-Za-z\\d]/.test(e);return[n,r,c,a].filter(Boolean).length<3?{ok:!1,message:t.weak}:{ok:!0,message:t.strong}}function le({copy:e,mode:t,onModeChange:n,loginId:r,onLoginIdChange:c,displayName:a,onDisplayNameChange:u,password:o,onPasswordChange:d,passwordConfirm:b,onPasswordConfirmChange:f,secureMode:g,onSecureModeChange:w,availability:x,passwordHint:T,onSubmit:I,compact:k}){return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"tabs",children:[s.jsx("button",{type:"button",className:t==="login"?"active":"",onClick:()=>n("login"),children:e.access.login}),s.jsx("button",{type:"button",className:t==="register"?"active":"",onClick:()=>n("register"),children:e.access.register})]}),t==="register"?s.jsxs("form",{onSubmit:I,className:`auth-form ${k?"compact":""}`.trim(),children:[s.jsxs("label",{children:[e.access.loginId,s.jsx("input",{type:"text",value:r,onChange:S=>c(S.target.value)})]}),s.jsxs("label",{children:[e.access.displayName,s.jsx("input",{type:"text",value:a,onChange:S=>u(S.target.value)})]}),s.jsxs("label",{children:[e.access.password,s.jsx("input",{type:"password",value:o,onChange:S=>d(S.target.value)})]}),T&&s.jsx("span",{className:"hint",children:T}),s.jsxs("label",{children:[e.access.confirm,s.jsx("input",{type:"password",value:b,onChange:S=>f(S.target.value)})]}),x&&s.jsx("span",{className:"hint",children:x}),s.jsx("button",{type:"submit",className:"cta",children:e.access.create})]}):s.jsxs("form",{onSubmit:I,className:`auth-form ${k?"compact":""}`.trim(),children:[s.jsxs("label",{children:[e.access.loginId,s.jsx("input",{type:"text",value:r,onChange:S=>c(S.target.value)})]}),s.jsxs("label",{children:[e.access.password,s.jsx("input",{type:"password",value:o,onChange:S=>d(S.target.value)})]}),s.jsxs("label",{className:"toggle",children:[s.jsx("input",{type:"checkbox",checked:g,onChange:S=>w(S.target.checked)}),e.access.secureMode]}),s.jsx("button",{type:"submit",className:"cta",children:e.access.signIn})]})]})}function de({copy:e,mode:t,onModeChange:n,loginId:r,onLoginIdChange:c,displayName:a,onDisplayNameChange:u,password:o,onPasswordChange:d,passwordConfirm:b,onPasswordConfirmChange:f,secureMode:g,onSecureModeChange:w,availability:x,passwordHint:T,status:I,onSubmit:k,onCheckSession:S,onToggleMode:p,onLogout:E,sessionInfo:y,compact:C=!1,showSessionActions:h=!0}){return s.jsxs("div",{className:`auth-panel ${C?"auth-panel-compact":""}`.trim(),children:[s.jsx(le,{copy:e,mode:t,onModeChange:n,loginId:r,onLoginIdChange:c,displayName:a,onDisplayNameChange:u,password:o,onPasswordChange:d,passwordConfirm:b,onPasswordConfirmChange:f,secureMode:g,onSecureModeChange:w,availability:x,passwordHint:T,onSubmit:k,compact:C}),I.type!=="idle"&&s.jsxs("div",{className:`status ${I.type}`,children:[s.jsx("strong",{children:e.access.statusTitle}),s.jsx("span",{children:I.message??e.access.statusReady})]}),h&&S&&p&&E&&s.jsxs("div",{className:"session-actions",children:[s.jsx("button",{type:"button",onClick:S,children:e.access.checkSession}),s.jsx("button",{type:"button",onClick:p,children:e.access.toggleMode}),s.jsx("button",{type:"button",onClick:E,children:e.access.logout})]}),y&&s.jsx("p",{className:"session-info",children:y})]})}function qt({copy:e,mode:t,onModeChange:n,loginId:r,onLoginIdChange:c,displayName:a,onDisplayNameChange:u,password:o,onPasswordChange:d,passwordConfirm:b,onPasswordConfirmChange:f,secureMode:g,onSecureModeChange:w,availability:x,passwordHint:T,onSubmit:I,status:k,open:S,onClose:p,context:E}){const[y,C]=m.useState(S),[h,l]=m.useState(!1);if(m.useEffect(()=>{if(S){C(!0),l(!1);const $=window.requestAnimationFrame(()=>l(!0));return()=>window.cancelAnimationFrame($)}if(!S&&y){l(!1);const $=window.setTimeout(()=>C(!1),720);return()=>window.clearTimeout($)}},[S,y]),!y)return null;const v=E==="parish"?e.parish.title:E==="cogita"?e.cogita.title:E==="account"?e.account.title:e.loginCard.contextDefault;return s.jsx("div",{className:`login-overlay ${h?"is-active":""}`,onClick:p,children:s.jsxs("div",{className:"login-card",onClick:$=>$.stopPropagation(),children:[s.jsxs("div",{className:"login-card-header",children:[s.jsx("img",{src:"/logo_new.png",alt:e.loginCard.title}),s.jsx("span",{children:e.loginCard.title})]}),s.jsx("p",{className:"login-card-note",children:v}),s.jsx(de,{copy:e,mode:t,onModeChange:n,loginId:r,onLoginIdChange:c,displayName:a,onDisplayNameChange:u,password:o,onPasswordChange:d,passwordConfirm:b,onPasswordConfirmChange:f,secureMode:g,onSecureModeChange:w,availability:x,passwordHint:T,onSubmit:I,status:k,compact:!0,showSessionActions:!1})]})})}function he({value:e,onChange:t}){const[n,r]=m.useState(!1),c=m.useRef(null);m.useEffect(()=>{const u=d=>{c.current&&(c.current.contains(d.target)||r(!1))},o=d=>{d.key==="Escape"&&r(!1)};return document.addEventListener("mousedown",u),document.addEventListener("keydown",o),()=>{document.removeEventListener("mousedown",u),document.removeEventListener("keydown",o)}},[]);const a=u=>{t(u),r(!1)};return s.jsxs("div",{className:`lang-select ${n?"open":""}`,ref:c,children:[s.jsx("button",{type:"button",className:"lang-button",onClick:()=>r(u=>!u),children:e.toUpperCase()}),s.jsxs("div",{className:`lang-menu ${n?"open":""}`,children:[s.jsx("button",{type:"button",onClick:()=>a("pl"),children:"PL"}),s.jsx("button",{type:"button",onClick:()=>a("en"),children:"EN"}),s.jsx("button",{type:"button",onClick:()=>a("de"),children:"DE"})]})]})}function fe({copy:e,label:t,secureMode:n,onNavigateProfile:r,onToggleSecureMode:c,onLogout:a}){const[u,o]=m.useState(!1),d=m.useRef(null),b=m.useRef("unknown");return m.useEffect(()=>{const f=w=>{d.current&&(d.current.contains(w.target)||o(!1))},g=w=>{w.key==="Escape"&&o(!1)};return document.addEventListener("mousedown",f),document.addEventListener("keydown",g),()=>{document.removeEventListener("mousedown",f),document.removeEventListener("keydown",g)}},[]),s.jsxs("div",{className:`profile-menu ${u?"open":""}`,ref:d,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),onPointerDown:f=>{b.current=f.pointerType},children:[s.jsx("button",{type:"button",className:"profile-button",onClick:f=>{if(b.current==="touch"||b.current==="pen"){f.preventDefault(),o(g=>!g);return}r()},children:t}),s.jsxs("div",{className:`profile-dropdown ${u?"open":""}`,children:[s.jsx("button",{type:"button",onClick:()=>{r(),o(!1)},children:e.accountMenu.profile}),s.jsx("button",{type:"button",onClick:()=>{c(),o(!1)},children:n?e.accountMenu.secureModeOff:e.accountMenu.secureModeOn}),s.jsx("button",{type:"button",onClick:()=>{a(),o(!1)},children:e.accountMenu.logout})]})]})}function ge({copy:e,label:t,isAuthenticated:n,secureMode:r,onLogin:c,onProfileNavigate:a,onToggleSecureMode:u,onLogout:o,variant:d="cta"}){return n?s.jsx(fe,{copy:e,label:t,secureMode:r,onNavigateProfile:a,onToggleSecureMode:u,onLogout:o}):s.jsx("button",{type:"button",className:d,onClick:c,children:t})}function Ut({copy:e,language:t,onLanguageChange:n,onNavigate:r,onOpenPanel:c,onAuthAction:a,authLabel:u,authCtaLabel:o,showProfileMenu:d,onProfileNavigate:b,onToggleSecureMode:f,onLogout:g,secureMode:w,panelOpen:x,activeSectionId:T,onSectionChange:I}){const k=m.useRef(null),S=()=>{const h=k.current,l=(h==null?void 0:h.clientHeight)??0;return Number.isFinite(l)&&l>1?l:window.innerHeight||1},p=m.useMemo(()=>{var v,$;const h=((v=e.faq.items[0])==null?void 0:v.a)??e.hero.subtitle,l=(($=e.legal.items[0])==null?void 0:$.desc)??e.hero.subtitle;return[{id:"section-1",title:e.hero.headline,text:e.hero.subtitle,ctaLabel:o,ctaAction:a},{id:"section-2",title:e.parish.title,text:e.parish.subtitle,ctaLabel:e.nav.parish,ctaAction:()=>r("parish")},{id:"section-3",title:e.cogita.title,text:e.cogita.subtitle,ctaLabel:e.nav.cogita,ctaAction:()=>r("cogita")},{id:"section-4",title:e.faq.title,text:h,ctaLabel:e.nav.faq,ctaAction:()=>c("faq"),variant:"secondary"},{id:"section-5",title:e.legal.title,text:l,ctaLabel:e.nav.legal,ctaAction:()=>c("legal"),variant:"secondary"}]},[o,e,a,r,c]),E=m.useMemo(()=>{const h=T??"section-1",l=p.findIndex(v=>v.id===h);return l>=0?l:0},[T,p]),[y,C]=m.useState(E);return m.useEffect(()=>(document.body.style.overflow=x?"hidden":"",()=>{document.body.style.overflow=""}),[x]),m.useEffect(()=>{const h=k.current;if(!h)return;let l;const v=()=>{l&&window.clearTimeout(l),l=window.setTimeout(()=>{const $=S();if(!Number.isFinite($)||$<=1)return;const j=Math.round(h.scrollTop/$);C(Math.max(0,Math.min(j,p.length-1)))},40)};return h.addEventListener("scroll",v,{passive:!0}),()=>{h.removeEventListener("scroll",v),l&&window.clearTimeout(l)}},[p.length]),m.useEffect(()=>{var l;if(x)return;const h=((l=p[y])==null?void 0:l.id)??"section-1";T!==h&&(I==null||I(h))},[y,T,I,x,p]),m.useEffect(()=>{if(x)return;const h=k.current;if(!h)return;const l=p.findIndex(v=>v.id===(T??"section-1"));if(l>=0){const v=S();if(Number.isFinite(v)&&v>1)h.scrollTo({top:l*v,behavior:"smooth"}),C(l);else{const $=window.requestAnimationFrame(()=>{const j=S();Number.isFinite(j)&&j>1&&(h.scrollTo({top:l*j,behavior:"smooth"}),C(l))});return()=>window.cancelAnimationFrame($)}}},[T,x,p]),m.useEffect(()=>{const h=l=>{if(x)return;const v=k.current,$=S();if(!(!v||!Number.isFinite($)||$<=1)){if(["ArrowDown","PageDown"].includes(l.key)){l.preventDefault();const j=Math.min(y+1,p.length-1);v.scrollTo({top:j*$,behavior:"auto"})}if(["ArrowUp","PageUp"].includes(l.key)){l.preventDefault();const j=Math.max(y-1,0);v.scrollTo({top:j*$,behavior:"auto"})}}};return window.addEventListener("keydown",h),()=>window.removeEventListener("keydown",h)},[y,x,p.length]),s.jsxs("div",{className:`home ${x?"home-panel-open":""}`,children:[s.jsxs("header",{className:"home-header",children:[s.jsx("button",{type:"button",className:"brand",onClick:()=>r("home"),children:s.jsx("img",{src:"/logo_new.svg",alt:e.loginCard.title})}),s.jsxs("nav",{className:"home-nav",children:[s.jsx("button",{type:"button",onClick:()=>r("parish"),children:e.nav.parish}),s.jsx("button",{type:"button",onClick:()=>r("cogita"),children:e.nav.cogita}),s.jsx("button",{type:"button",onClick:()=>c("faq"),children:e.nav.faq}),s.jsx("button",{type:"button",onClick:()=>c("legal"),children:e.nav.legal})]}),s.jsxs("div",{className:"home-actions",children:[s.jsx(he,{value:t,onChange:n}),s.jsx(ge,{copy:e,label:u,isAuthenticated:d,secureMode:w,onLogin:a,onProfileNavigate:b,onToggleSecureMode:f,onLogout:g,variant:"cta"})]})]}),s.jsx("main",{ref:k,className:"home-viewport","aria-hidden":x?"true":"false",children:p.map((h,l)=>s.jsx("section",{id:h.id,className:`home-section section-${l+1} ${y===l?"is-active":""}`,children:s.jsxs("div",{className:"home-content",children:[s.jsx("h1",{children:h.title}),s.jsx("p",{children:h.text}),s.jsx("button",{type:"button",className:`cta ${h.variant==="secondary"?"ghost":""}`,onClick:h.ctaAction,children:h.ctaLabel})]})},h.id))}),s.jsx("div",{className:"home-dots",children:p.map((h,l)=>s.jsx("button",{className:`dot ${y===l?"active":""}`,"aria-label":h.title,type:"button",onClick:()=>{const v=k.current;v&&(v.scrollTo({top:l*v.clientHeight,behavior:"smooth"}),C(l))}},h.id))}),s.jsxs("footer",{className:"home-footer",children:[s.jsx("span",{children:e.footer.headline}),s.jsxs("div",{className:"footer-links",children:[s.jsx("button",{type:"button",onClick:()=>c("legal"),children:e.footer.imprint}),s.jsx("button",{type:"button",onClick:()=>c("faq"),children:e.footer.security})]})]})]})}const X=e=>{const t=[];let n="",r=0;const c=u=>{let o=0;for(let d=u-1;d>=0&&e[d]==="\\";d-=1)o+=1;return o%2===1},a=()=>{n&&(t.push({type:"text",value:n.replace(/\\\$/g,"$")}),n="")};for(;r<e.length;){const u=e[r];if(u==="$"&&!c(r)){const o=e[r+1]==="$"&&!c(r+1),d=o?"$$":"$",b=r+d.length;let f=b,g=!1;for(;f<e.length;){if(e.startsWith(d,f)&&!c(f)){g=!0;break}f+=1}if(g){a();const w=e.slice(b,f);t.push({type:o?"block":"inline",value:w}),r=f+d.length;continue}}n+=u,r+=1}return a(),t},L=(e,t)=>{if(!e)return null;const n=e.split(/\r?\n/);return n.length===1?s.jsx("span",{children:e},t):s.jsx("span",{children:n.map((r,c)=>s.jsxs("span",{children:[r,c<n.length-1?s.jsx("br",{}):null]},`${t}-${c}`))},t)};function Kt({value:e,className:t,mode:n="math"}){if(!e)return null;if(n==="math")return s.jsx("div",{className:t,children:s.jsx(N.BlockMath,{math:e,renderError:()=>s.jsx("span",{children:e}),strict:"ignore"})});const r=X(e);return r.some(a=>a.type!=="text")?s.jsx("div",{className:t,children:r.map((a,u)=>{const o=`latex-${u}`;return a.type==="text"?L(a.value,o):a.type==="block"?s.jsx(N.BlockMath,{math:a.value,strict:"ignore",renderError:()=>s.jsx("span",{children:a.value})},o):s.jsx(N.InlineMath,{math:a.value,strict:"ignore",renderError:()=>s.jsx("span",{children:a.value})},o)})}):s.jsx("div",{className:t,children:L(e,"latex-text")})}function Ft({value:e,className:t,mode:n="math"}){if(!e)return null;if(n==="math")return s.jsx("span",{className:t,children:s.jsx(N.InlineMath,{math:e,renderError:()=>s.jsx("span",{children:e}),strict:"ignore"})});const r=X(e);return r.some(a=>a.type!=="text")?s.jsx("span",{className:t,children:r.map((a,u)=>{const o=`latex-inline-${u}`;return a.type==="text"?L(a.value,o):a.type==="block"?s.jsx(N.InlineMath,{math:a.value,strict:"ignore",renderError:()=>s.jsx("span",{children:a.value})},o):s.jsx(N.InlineMath,{math:a.value,strict:"ignore",renderError:()=>s.jsx("span",{children:a.value})},o)})}):s.jsx("span",{className:t,children:e})}export{yt as $,ge as A,se as B,Xe as C,_e as D,Ze as E,Qe as F,Ve as G,F as H,dt as I,ft as J,ht as K,he as L,J as M,ve as N,Oe as O,$e as P,Te as Q,vt as R,We as S,Je as T,nt as U,st as V,lt as W,rt as X,bt as Y,it as Z,pt as _,Ae as a,jt as a0,Et as a1,Ot as a2,kt as a3,Ct as a4,Pt as a5,Nt as a6,Mt as a7,Rt as a8,Lt as a9,Gt as aa,Jt as ab,At as ac,Y as ad,Ut as ae,de as af,qt as ag,Dt as ah,pe as ai,Ge as aj,Le as ak,Me as al,Ce as am,ke as an,Ne as ao,Ee as ap,Be as aq,ye as ar,je as as,Ie as at,Pe as au,Re as av,Se as aw,we as ax,Bt as ay,Ke as b,He as c,ut as d,qe as e,gt as f,De as g,Ye as h,Kt as i,Ft as j,wt as k,$t as l,mt as m,St as n,ot as o,ct as p,at as q,et as r,Ue as s,tt as t,xt as u,It as v,Tt as w,O as x,Fe as y,ze as z};
